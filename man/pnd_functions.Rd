% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pnd_functions.R
\name{pnd_functions}
\alias{pnd_functions}
\alias{dpnd}
\alias{ppnd}
\alias{qpnd}
\alias{rpnd}
\title{The Power Normal Distribution}
\usage{
dpnd(x, lambda, mu, sigma, log = FALSE)

ppnd(x, lambda, mu, sigma)

qpnd(p, lambda, mu, sigma)

rpnd(n, lambda, mu, sigma)
}
\arguments{
\item{x}{Vector of quantiles.}

\item{lambda}{Numeric scalar; the shape parameter.}

\item{mu}{Numeric scalar; the location parameter.}

\item{sigma}{Numeric scalar; the scale parameter.}

\item{log}{Logical; if \code{TRUE}, returns the log-density.}

\item{p}{Vector of probabilities.}

\item{n}{Number of observations.}
}
\value{
\code{dpnd()} returns the PDF,
\code{ppnd()} returns the CDF,
\code{qpnd()} returns the quantile function, and
\code{rpnd()} generates random values from the distribution.
}
\description{
Probability density function (PDF), cumulative distribution function (CDF),
quantile function, and random number generation for the power normal
distribution (PND).
}
\details{
The power normal distribution (PND; Goto and Inoue, 1980) describes the
distribution of a positive random variable \eqn{X} such that the Box–Cox
transformation \eqn{Z(\lambda)} follows a (possibly truncated) normal
distribution (Box & Cox, 1964):

\deqn{
Z(\lambda) =
\begin{cases}
(X^\lambda - 1)/\lambda, & \lambda \neq 0, \\
\log(X), & \lambda = 0.
\end{cases}
}

The PDF of the PND is:
\deqn{
f_{\mathrm{PN}}(x; \lambda, \mu, \sigma) =
\frac{x^{\lambda - 1}}{A(K)} f_{\mathrm{N}}(z(\lambda); \mu, \sigma),
}
where \eqn{f_{\mathrm{N}}} is the normal PDF, \eqn{z(\lambda)} is the
Box–Cox transformed value, and \eqn{A(K)} is the normalization constant:

\deqn{
A(K) =
\begin{cases}
\Phi(\mathrm{sgn}(\lambda)K), & \lambda \neq 0, \\
1, & \lambda = 0,
\end{cases}
}
with \eqn{K = (1 + \lambda \mu)/(\lambda \sigma)} and \eqn{\Phi} the
standard normal CDF.

The CDF is:
\deqn{
F_{\mathrm{PN}}(x; \lambda, \mu, \sigma) =
\begin{cases}
\frac{1}{A(K)}\left\{ \Phi\left( \frac{z(\lambda) - \mu}{\sigma} \right) -
\Phi(-K) \right\}, & \lambda > 0, \\
\frac{1}{A(K)} \Phi\left( \frac{z(\lambda) - \mu}{\sigma} \right), & \lambda
\le 0.
\end{cases}
}

The quantile function (i.e., the \eqn{100p} percentile \eqn{\xi_p}) is:
\deqn{
\xi_p(\lambda, \mu, \sigma) =
\begin{cases}
\left\{ \lambda (\mu + \sigma z_{p^*}) + 1 \right\}^{1/\lambda}, & \lambda
\ne 0, \\
\exp(\mu + \sigma z_p), & \lambda = 0,
\end{cases}
}
where \eqn{z_p} and \eqn{z_{p^*}} are quantiles of the standard normal
distribution, and

\deqn{
p^* =
\begin{cases}
1 - A(K)(1 - p), & \lambda > 0, \\
A(K)p, & \lambda < 0.
\end{cases}
}

In practice, parameters are often estimated assuming \eqn{A(K) = 1}
(i.e., the truncation is negligible). This simplification is generally
acceptable unless extreme quantiles (e.g., 97.5%) are of interest.
Estimation under this assumption can be performed using \code{bct.v()}
from the \pkg{bcmixed} package.
}
\examples{
dpnd(x = 5, lambda = 0.5, mu = 10, sigma = 2)
ppnd(x = 5, lambda = 0.5, mu = 10, sigma = 2)
qpnd(p = 0.6, lambda = -0.5, mu = 1, sigma = 0.1)
rpnd(n = 20, lambda = -0.5, mu = 1, sigma = 0.1)

}
\references{
Box, G.E.P., & Cox, D.R. (1964). An analysis of transformations.
\emph{Journal of the Royal Statistical Society: Series B}, 26, 211–246.
\url{https://doi.org/10.1111/j.2517-6161.1964.tb00553.x}

Goto, M., & Inoue, T. (1980). Some properties of the power normal
distribution. \emph{Japanese Journal of Biometrics}, 1, 28–54.
\url{https://doi.org/10.5691/jjb.1.28}

Maruo, K., Shirahata, S., & Goto, M. (2011). Underlying assumptions of the
power-normal distribution. \emph{Behaviormetrika}, 38(1), 85–95.
\url{https://doi.org/10.2333/bhmk.38.85}

Maruo, K., Ishii, R., Yamaguchi, Y., & Gosho, M. (2021). bcmixed: A package
for median inference on longitudinal data with the Box–Cox transformation.
\emph{The R Journal}, 13(2), 253–265.
\url{https://doi.org/10.32614/RJ-2021-083}
}
\seealso{
\code{\link[powerNormal]{dpnd}},
\code{\link[powerNormal]{ppnd}},
\code{\link[powerNormal]{qpnd}},
\code{\link[powerNormal]{rpnd}},
\code{\link[bcmixed]{bct.v}}
}
